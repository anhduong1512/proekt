{"ast":null,"code":"var NativeModules = require(\"react-native\").NativeModules;\n\nvar DB_STATE_INIT, DB_STATE_OPEN, READ_ONLY_REGEX, SQLiteFactory, SQLitePlugin, SQLitePluginTransaction, argsArray, dblocations, newSQLError, txLocks;\nvar plugin = {};\nREAD_ONLY_REGEX = /^(\\s|;)*(?:alter|create|delete|drop|insert|reindex|replace|update)/i;\nDB_STATE_INIT = \"INIT\";\nDB_STATE_OPEN = \"OPEN\";\ntxLocks = {};\n\nnewSQLError = function newSQLError(error, code) {\n  var sqlError;\n  sqlError = error;\n\n  if (!code) {\n    code = 0;\n  }\n\n  if (!sqlError) {\n    sqlError = new Error(\"a plugin had an error but provided no response\");\n    sqlError.code = code;\n  }\n\n  if (typeof sqlError === \"string\") {\n    sqlError = new Error(error);\n    sqlError.code = code;\n  }\n\n  if (!sqlError.code && sqlError.message) {\n    sqlError.code = code;\n  }\n\n  if (!sqlError.code && !sqlError.message) {\n    sqlError = new Error(\"an unknown error was returned: \" + JSON.stringify(sqlError));\n    sqlError.code = code;\n  }\n\n  return sqlError;\n};\n\nvar nextTick = setImmediate || function (fun) {\n  setTimeout(fun, 0);\n};\n\nif (global.window) {\n  nextTick = window.setImmediate || function (fun) {\n    window.setTimeout(fun, 0);\n  };\n}\n\nargsArray = function argsArray(fun) {\n  return function () {\n    var args, i, len;\n    len = arguments.length;\n\n    if (len) {\n      args = [];\n      i = -1;\n\n      while (++i < len) {\n        args[i] = arguments[i];\n      }\n\n      return fun.call(this, args);\n    } else {\n      return fun.call(this, []);\n    }\n  };\n};\n\nplugin.exec = function (method, options, success, error) {\n  if (plugin.sqlitePlugin.DEBUG) {\n    plugin.log(\"SQLite.\" + method + \"(\" + JSON.stringify(options) + \")\");\n  }\n\n  NativeModules[\"SQLite\"][method](options, success, error);\n};\n\nplugin.log = function () {\n  if (plugin.sqlitePlugin.DEBUG) {\n    var _console;\n\n    (_console = console).log.apply(_console, arguments);\n  }\n};\n\nplugin.warn = function () {\n  var _console2;\n\n  (_console2 = console).warn.apply(_console2, arguments);\n};\n\nplugin.error = function () {\n  var _console3;\n\n  (_console3 = console).error.apply(_console3, arguments);\n};\n\nSQLitePlugin = function SQLitePlugin(openargs, openSuccess, openError) {\n  var dbname;\n\n  if (!(openargs && openargs[\"name\"])) {\n    throw newSQLError(\"Cannot create a SQLitePlugin db instance without a db name\");\n  }\n\n  dbname = openargs.name;\n\n  if (typeof dbname !== \"string\") {\n    throw newSQLError(\"sqlite plugin database name must be a string\");\n  }\n\n  this.openargs = openargs;\n  this.dbname = dbname;\n  this.openSuccess = openSuccess;\n  this.openError = openError;\n  this.openSuccess || (this.openSuccess = function () {\n    plugin.log(\"DB opened: \" + dbname);\n  });\n  this.openError || (this.openError = function (e) {\n    plugin.log(e.message);\n  });\n  this.open(this.openSuccess, this.openError);\n};\n\nSQLitePlugin.prototype.databaseFeatures = {\n  isSQLitePluginDatabase: true\n};\nSQLitePlugin.prototype.openDBs = {};\n\nSQLitePlugin.prototype.addTransaction = function (t) {\n  if (!txLocks[this.dbname]) {\n    txLocks[this.dbname] = {\n      queue: [],\n      inProgress: false\n    };\n  }\n\n  txLocks[this.dbname].queue.push(t);\n\n  if (this.dbname in this.openDBs && this.openDBs[this.dbname] !== DB_STATE_INIT) {\n    this.startNextTransaction();\n  } else {\n    if (this.dbname in this.openDBs) {\n      plugin.log(\"new transaction is waiting for open operation\");\n    } else {\n      plugin.log(\"database is closed, new transaction is [stuck] waiting until db is opened again!\");\n    }\n  }\n};\n\nSQLitePlugin.prototype.transaction = function (fn, error, success) {\n  if (!this.openDBs[this.dbname]) {\n    error(newSQLError(\"database not open\"));\n    return;\n  }\n\n  this.addTransaction(new SQLitePluginTransaction(this, fn, error, success, true, false));\n};\n\nSQLitePlugin.prototype.readTransaction = function (fn, error, success) {\n  if (!this.openDBs[this.dbname]) {\n    error(newSQLError(\"database not open\"));\n    return;\n  }\n\n  this.addTransaction(new SQLitePluginTransaction(this, fn, error, success, false, true));\n};\n\nSQLitePlugin.prototype.startNextTransaction = function () {\n  var self;\n  self = this;\n  nextTick(function (_this) {\n    return function () {\n      var txLock;\n\n      if (!(_this.dbname in _this.openDBs) || _this.openDBs[_this.dbname] !== DB_STATE_OPEN) {\n        plugin.log(\"cannot start next transaction: database not open\");\n        return;\n      }\n\n      txLock = txLocks[self.dbname];\n\n      if (!txLock) {\n        plugin.log(\"cannot start next transaction: database connection is lost\");\n      } else if (txLock.queue.length > 0 && !txLock.inProgress) {\n        txLock.inProgress = true;\n        txLock.queue.shift().start();\n      }\n    };\n  }(this));\n};\n\nSQLitePlugin.prototype.abortAllPendingTransactions = function () {\n  var j, len1, ref, tx, txLock;\n  txLock = txLocks[this.dbname];\n\n  if (!!txLock && txLock.queue.length > 0) {\n    ref = txLock.queue;\n\n    for (j = 0, len1 = ref.length; j < len1; j++) {\n      tx = ref[j];\n      tx.abortFromQ(newSQLError(\"Invalid database handle\"));\n    }\n\n    txLock.queue = [];\n    txLock.inProgress = false;\n  }\n};\n\nSQLitePlugin.prototype.sqlBatch = function (sqlStatements, success, error) {\n  var batchList, j, len1, myfn, st;\n\n  if (!sqlStatements || sqlStatements.constructor !== Array) {\n    throw newSQLError(\"sqlBatch expects an array\");\n  }\n\n  batchList = [];\n\n  for (j = 0, len1 = sqlStatements.length; j < len1; j++) {\n    st = sqlStatements[j];\n\n    if (st.constructor === Array) {\n      if (st.length === 0) {\n        throw newSQLError(\"sqlBatch array element of zero (0) length\");\n      }\n\n      batchList.push({\n        sql: st[0],\n        params: st.length === 0 ? [] : st[1]\n      });\n    } else {\n      batchList.push({\n        sql: st,\n        params: []\n      });\n    }\n  }\n\n  myfn = function myfn(tx) {\n    var elem, k, len2, results;\n    results = [];\n\n    for (k = 0, len2 = batchList.length; k < len2; k++) {\n      elem = batchList[k];\n      results.push(tx.addStatement(elem.sql, elem.params, null, null));\n    }\n\n    return results;\n  };\n\n  var mysuccess = function mysuccess() {\n    if (!!success) {\n      return success();\n    }\n  };\n\n  var myerror = function myerror(e) {\n    if (!!error) {\n      return error(e);\n    } else {\n      plugin.log(\"Error handler not provided: \", e);\n    }\n  };\n\n  this.addTransaction(new SQLitePluginTransaction(this, myfn, myerror, mysuccess, true, false));\n};\n\nSQLitePlugin.prototype.open = function (success, error) {\n  var openerrorcb, opensuccesscb;\n\n  if (this.dbname in this.openDBs && this.openDBs[this.dbname] === DB_STATE_OPEN) {\n    plugin.log(\"database already open: \" + this.dbname);\n    nextTick(function (_this) {\n      return function () {\n        success(_this);\n      };\n    }(this));\n  } else {\n    plugin.log(\"OPEN database: \" + this.dbname);\n\n    opensuccesscb = function (_this) {\n      return function () {\n        var txLock;\n\n        if (!_this.openDBs[_this.dbname]) {\n          plugin.log(\"database was closed during open operation\");\n        }\n\n        if (_this.dbname in _this.openDBs) {\n          _this.openDBs[_this.dbname] = DB_STATE_OPEN;\n        }\n\n        if (!!success) {\n          success(_this);\n        }\n\n        txLock = txLocks[_this.dbname];\n\n        if (!!txLock && txLock.queue.length > 0 && !txLock.inProgress) {\n          _this.startNextTransaction();\n        }\n      };\n    }(this);\n\n    openerrorcb = function (_this) {\n      return function () {\n        plugin.log(\"OPEN database: \" + _this.dbname + \" failed, aborting any pending transactions\");\n\n        if (!!error) {\n          error(newSQLError(\"Could not open database\"));\n        }\n\n        delete _this.openDBs[_this.dbname];\n\n        _this.abortAllPendingTransactions();\n      };\n    }(this);\n\n    this.openDBs[this.dbname] = DB_STATE_INIT;\n    plugin.exec(\"open\", this.openargs, opensuccesscb, openerrorcb);\n  }\n};\n\nSQLitePlugin.prototype.close = function (success, error) {\n  if (this.dbname in this.openDBs) {\n    if (txLocks[this.dbname] && txLocks[this.dbname].inProgress) {\n      plugin.log(\"cannot close: transaction is in progress\");\n      error(newSQLError(\"database cannot be closed while a transaction is in progress\"));\n      return;\n    }\n\n    plugin.log(\"CLOSE database: \" + this.dbname);\n    delete this.openDBs[this.dbname];\n\n    if (txLocks[this.dbname]) {\n      plugin.log(\"closing db with transaction queue length: \" + txLocks[this.dbname].queue.length);\n    } else {\n      plugin.log(\"closing db with no transaction lock state\");\n    }\n\n    var mysuccess = function mysuccess(t, r) {\n      if (!!success) {\n        return success(r);\n      }\n    };\n\n    var myerror = function myerror(t, e) {\n      if (!!error) {\n        return error(e);\n      } else {\n        plugin.log(\"Error handler not provided: \", e);\n      }\n    };\n\n    plugin.exec(\"close\", {\n      path: this.dbname\n    }, mysuccess, myerror);\n  } else {\n    var err = \"cannot close: database is not open\";\n    plugin.log(err);\n\n    if (error) {\n      nextTick(function () {\n        return error(err);\n      });\n    }\n  }\n};\n\nSQLitePlugin.prototype.attach = function (dbNameToAttach, dbAlias, success, error) {\n  if (this.dbname in this.openDBs) {\n    if (txLocks[this.dbname] && txLocks[this.dbname].inProgress) {\n      plugin.log(\"cannot attach: transaction is in progress\");\n      error(newSQLError(\"database cannot be attached while a transaction is in progress\"));\n      return;\n    }\n\n    plugin.log(\"ATTACH database \" + dbNameToAttach + \" to \" + this.dbname + \" with alias \" + dbAlias);\n\n    var mysuccess = function mysuccess(t, r) {\n      if (!!success) {\n        return success(r);\n      }\n    };\n\n    var myerror = function myerror(e) {\n      if (!!error) {\n        return error(e);\n      } else {\n        plugin.log(\"Error handler not provided: \", e);\n      }\n    };\n\n    plugin.exec(\"attach\", {\n      path: this.dbname,\n      dbName: dbNameToAttach,\n      dbAlias: dbAlias\n    }, mysuccess, myerror);\n  } else {\n    var err = \"cannot attach: database is not open\";\n\n    if (error) {\n      nextTick(function () {\n        return error(err);\n      });\n    }\n  }\n};\n\nSQLitePlugin.prototype.detach = function (dbAlias, success, error) {\n  if (this.dbname in this.openDBs) {\n    if (txLocks[this.dbname] && txLocks[this.dbname].inProgress) {\n      plugin.log(\"cannot attach: transaction is in progress\");\n      error(newSQLError(\"database cannot be attached while a transaction is in progress\"));\n      return;\n    }\n\n    plugin.log(\"DETACH database \" + dbAlias + \" from \" + this.dbname);\n\n    var mysuccess = function mysuccess(t, r) {\n      if (!!success) {\n        return success(r);\n      }\n    };\n\n    var myerror = function myerror(e) {\n      plugin.log(\"ERR\", e);\n\n      if (!!error) {\n        return error(e);\n      } else {\n        plugin.log(\"Error handler not provided: \", e);\n      }\n    };\n\n    this.executeSql(\"DETACH DATABASE \" + dbAlias, [], mysuccess, myerror);\n  } else {\n    var err = \"cannot attach: database is not open\";\n    plugin.log(err);\n\n    if (error) {\n      nextTick(function () {\n        return error(err);\n      });\n    }\n  }\n};\n\nSQLitePlugin.prototype.executeSql = function (statement, params, success, error) {\n  var myerror, myfn, mysuccess;\n\n  mysuccess = function mysuccess(t, r) {\n    if (!!success) {\n      return success(r);\n    }\n  };\n\n  myerror = function myerror(t, e) {\n    if (!!error) {\n      return error(e);\n    } else {\n      plugin.log(\"Error handler not provided: \", e);\n    }\n  };\n\n  myfn = function myfn(tx) {\n    tx.addStatement(statement, params, mysuccess, myerror);\n  };\n\n  this.addTransaction(new SQLitePluginTransaction(this, myfn, null, null, false, false));\n};\n\nSQLitePluginTransaction = function SQLitePluginTransaction(db, fn, error, success, txlock, readOnly) {\n  if (typeof fn !== \"function\") {\n    var err = newSQLError(\"transaction expected a function\");\n\n    if (!!error) {\n      return error(err);\n    } else {\n      throw err;\n    }\n  }\n\n  this.db = db;\n  this.fn = fn;\n  this.error = error;\n  this.success = success;\n  this.txlock = txlock;\n  this.readOnly = readOnly;\n  this.executes = [];\n\n  if (txlock) {\n    this.addStatement(\"BEGIN\", [], null, function (tx, err) {\n      throw newSQLError(\"unable to begin transaction: \" + err.message, err.code);\n    });\n  } else {\n    this.addStatement(\"SELECT 1\", [], null, null);\n  }\n};\n\nSQLitePluginTransaction.prototype.start = function () {\n  var err;\n\n  try {\n    this.fn(this);\n    this.run();\n  } catch (_error) {\n    err = _error;\n    txLocks[this.db.dbname].inProgress = false;\n    this.db.startNextTransaction();\n\n    if (this.error) {\n      this.error(newSQLError(err));\n    }\n  }\n};\n\nSQLitePluginTransaction.prototype.executeSql = function (sql, values, success, error) {\n  var that = this;\n\n  if (that.finalized) {\n    throw {\n      message: \"InvalidStateError: DOM Exception 11: This transaction is already finalized. Transactions are committed\" + \" after its success or failure handlers are called. If you are using a Promise to handle callbacks, be aware that\" + \" implementations following the A+ standard adhere to run-to-completion semantics and so Promise resolution occurs\" + \" on a subsequent tick and therefore after the transaction commits.\",\n      code: 11\n    };\n  }\n\n  if (that.readOnly && READ_ONLY_REGEX.test(sql)) {\n    that.handleStatementFailure(error, {\n      message: \"invalid sql for a read-only transaction\"\n    });\n    return;\n  }\n\n  var mysuccess = function mysuccess(t, r) {\n    if (!!success) {\n      return success(t, r);\n    }\n  };\n\n  var myerror = function myerror(t, e) {\n    if (!!error) {\n      return error(e);\n    } else {\n      plugin.log(\"Error handler not provided: \", e);\n    }\n  };\n\n  that.addStatement(sql, values, mysuccess, myerror);\n};\n\nSQLitePluginTransaction.prototype.addStatement = function (sql, values, success, error) {\n  var j, len1, params, sqlStatement, t, v;\n  sqlStatement = typeof sql === \"string\" ? sql : sql.toString();\n  params = [];\n\n  if (!!values && values.constructor === Array) {\n    for (j = 0, len1 = values.length; j < len1; j++) {\n      v = values[j];\n      t = typeof v;\n\n      if (v === null || v === void 0 || t === \"number\" || t === \"string\") {\n        params.push(v);\n      } else if (t === \"boolean\") {\n        params.push(~~v);\n      } else if (t !== \"function\") {\n        params.push(v.toString());\n        plugin.warn(\"addStatement - parameter of type <\" + t + \"> converted to string using toString()\");\n      } else {\n        var errorMsg = \"Unsupported parameter type <\" + t + \"> found in addStatement()\";\n        plugin.error(errorMsg);\n        error(newSQLError(errorMsg));\n        return;\n      }\n    }\n  }\n\n  this.executes.push({\n    success: success,\n    error: error,\n    sql: sqlStatement,\n    params: params\n  });\n};\n\nSQLitePluginTransaction.prototype.handleStatementSuccess = function (handler, response) {\n  var payload, rows;\n\n  if (!handler) {\n    return;\n  }\n\n  rows = response.rows || [];\n  payload = {\n    rows: {\n      item: function item(i) {\n        return rows[i];\n      },\n      raw: function raw() {\n        return rows.slice();\n      },\n      length: rows.length\n    },\n    rowsAffected: response.rowsAffected || 0,\n    insertId: response.insertId || void 0\n  };\n  handler(this, payload);\n};\n\nSQLitePluginTransaction.prototype.handleStatementFailure = function (handler, response) {\n  if (!handler) {\n    throw newSQLError(\"a statement with no error handler failed: \" + response.message, response.code);\n  }\n\n  if (handler(this, response) !== false) {\n    throw newSQLError(\"a statement error callback did not return false: \" + response.message, response.code);\n  }\n};\n\nSQLitePluginTransaction.prototype.run = function () {\n  var batchExecutes, handlerFor, i, callbacks, request, tropts, tx, txFailure, waiting;\n  txFailure = null;\n  tropts = [];\n  batchExecutes = this.executes;\n  waiting = batchExecutes.length;\n  this.executes = [];\n  tx = this;\n\n  handlerFor = function handlerFor(index, didSucceed) {\n    return function (response) {\n      if (!txFailure) {\n        try {\n          if (didSucceed) {\n            tx.handleStatementSuccess(batchExecutes[index].success, response);\n          } else {\n            tx.handleStatementFailure(batchExecutes[index].error, newSQLError(response));\n          }\n        } catch (err) {\n          var errorMsg = JSON.stringify(err);\n          if (errorMsg === \"{}\") errorMsg = err.toString();\n          plugin.log(\"warning - exception while invoking a callback: \" + errorMsg);\n        }\n\n        if (!didSucceed) {\n          txFailure = newSQLError(response);\n        }\n      }\n\n      if (--waiting === 0) {\n        if (txFailure) {\n          tx.executes = [];\n          tx.abort(txFailure);\n        } else if (tx.executes.length > 0) {\n          tx.run();\n        } else {\n          tx.finish();\n        }\n      }\n    };\n  };\n\n  i = 0;\n  callbacks = [];\n\n  while (i < batchExecutes.length) {\n    request = batchExecutes[i];\n    callbacks.push({\n      success: handlerFor(i, true),\n      error: handlerFor(i, false)\n    });\n    tropts.push({\n      qid: 1111,\n      sql: request.sql,\n      params: request.params\n    });\n    i++;\n  }\n\n  var mysuccess = function mysuccess(result) {\n    var j, last, q, r, res, type;\n\n    if (result.length === 0) {\n      return;\n    }\n\n    last = result.length - 1;\n\n    for (j = 0; j <= last; ++j) {\n      r = result[j];\n      type = r.type;\n      res = r.result;\n      q = callbacks[j];\n\n      if (q) {\n        if (q[type]) {\n          q[type](res);\n        }\n      }\n    }\n  };\n\n  var myerror = function myerror(error) {\n    plugin.log(\"batch execution error: \", error);\n  };\n\n  plugin.exec(\"backgroundExecuteSqlBatch\", {\n    dbargs: {\n      dbname: this.db.dbname\n    },\n    executes: tropts\n  }, mysuccess, myerror);\n};\n\nSQLitePluginTransaction.prototype.abort = function (txFailure) {\n  var failed, succeeded, tx;\n\n  if (this.finalized) {\n    return;\n  }\n\n  tx = this;\n\n  succeeded = function succeeded(tx) {\n    txLocks[tx.db.dbname].inProgress = false;\n    tx.db.startNextTransaction();\n\n    if (tx.error) {\n      tx.error(txFailure);\n    }\n  };\n\n  failed = function failed(tx, err) {\n    txLocks[tx.db.dbname].inProgress = false;\n    tx.db.startNextTransaction();\n\n    if (tx.error) {\n      tx.error(newSQLError(\"error while trying to roll back: \" + err.message, err.code));\n    }\n  };\n\n  this.finalized = true;\n\n  if (this.txlock) {\n    this.addStatement(\"ROLLBACK\", [], succeeded, failed);\n    this.run();\n  } else {\n    succeeded(tx);\n  }\n};\n\nSQLitePluginTransaction.prototype.finish = function () {\n  var failed, succeeded, tx;\n\n  if (this.finalized) {\n    return;\n  }\n\n  tx = this;\n\n  succeeded = function succeeded(tx) {\n    txLocks[tx.db.dbname].inProgress = false;\n    tx.db.startNextTransaction();\n\n    if (tx.success) {\n      tx.success();\n    }\n  };\n\n  failed = function failed(tx, err) {\n    txLocks[tx.db.dbname].inProgress = false;\n    tx.db.startNextTransaction();\n\n    if (tx.error) {\n      tx.error(newSQLError(\"error while trying to commit: \" + err.message, err.code));\n    }\n  };\n\n  this.finalized = true;\n\n  if (this.txlock) {\n    this.addStatement(\"COMMIT\", [], succeeded, failed);\n    this.run();\n  } else {\n    succeeded(tx);\n  }\n};\n\nSQLitePluginTransaction.prototype.abortFromQ = function (sqlerror) {\n  if (this.error) {\n    this.error(sqlerror);\n  }\n};\n\ndblocations = {\n  \"default\": \"nosync\",\n  \"Documents\": \"docs\",\n  \"Library\": \"libs\",\n  \"Shared\": \"shared\"\n};\n\nSQLiteFactory = function SQLiteFactory() {};\n\nSQLiteFactory.prototype.DEBUG = function (debug) {\n  plugin.log(\"Setting debug to:\", debug);\n  plugin.sqlitePlugin.DEBUG = debug;\n};\n\nSQLiteFactory.prototype.sqliteFeatures = function () {\n  return {\n    isSQLitePlugin: true\n  };\n};\n\nSQLiteFactory.prototype.openDatabase = argsArray(function (args) {\n  var errorcb, first, okcb, openargs, readOnly;\n\n  if (args.length < 1) {\n    return null;\n  }\n\n  first = args[0];\n  openargs = null;\n\n  okcb = errorcb = function errorcb() {};\n\n  if (first.constructor === String) {\n    openargs = {\n      name: first,\n      dblocation: dblocations[\"default\"]\n    };\n\n    if (args.length >= 5) {\n      okcb = args[4];\n\n      if (args.length > 5) {\n        errorcb = args[5];\n      }\n    }\n  } else {\n    openargs = first;\n    readOnly = !!openargs.readOnly;\n\n    if (!readOnly && (!openargs.location || openargs.location.constructor !== String || !dblocations.hasOwnProperty(openargs.location))) {\n      openargs.dblocation = dblocations[\"default\"];\n    } else {\n      openargs.dblocation = dblocations[openargs.location];\n    }\n\n    if (!!openargs.createFromLocation) {\n      if (openargs.createFromLocation === 1) {\n        openargs.assetFilename = \"1\";\n      } else if (typeof openargs.createFromLocation === \"string\") {\n        openargs.assetFilename = openargs.createFromLocation;\n      }\n    }\n\n    if (!!openargs.androidDatabaseImplementation && openargs.androidDatabaseImplementation === 2) {\n      openargs.androidOldDatabaseImplementation = 1;\n    }\n\n    if (!!openargs.androidLockWorkaround && openargs.androidLockWorkaround === 1) {\n      openargs.androidBugWorkaround = 1;\n    }\n\n    if (args.length >= 2) {\n      okcb = args[1];\n\n      if (args.length > 2) {\n        errorcb = args[2];\n      }\n    }\n  }\n\n  return new SQLitePlugin(openargs, okcb, errorcb);\n});\n\nSQLiteFactory.prototype.echoTest = function (success, error) {\n  var inputTestValue = \"test-string\";\n\n  var mysuccess = function mysuccess(testValue) {\n    if (testValue === inputTestValue) {\n      return success();\n    } else {\n      return error(\"Mismatch: got: \" + testValue + \" , expected: \" + inputTestValue);\n    }\n  };\n\n  var myerror = function myerror(e) {\n    return error(e);\n  };\n\n  plugin.exec(\"echoStringValue\", {\n    value: inputTestValue\n  }, mysuccess, myerror);\n};\n\nSQLiteFactory.prototype.deleteDatabase = function (first, success, error) {\n  var args = {};\n\n  if (first.constructor === String) {\n    args.path = first;\n    args.dblocation = dblocations[\"default\"];\n  } else {\n    if (!(first && first[\"name\"])) {\n      throw new Error(\"Please specify db name via name property\");\n    }\n\n    args.path = first.name;\n\n    if (!first.location || first.location.constructor !== String || !dblocations.hasOwnProperty(first.location)) {\n      args.dblocation = dblocations[\"default\"];\n    } else {\n      args.dblocation = dblocations[first.location];\n    }\n  }\n\n  var mysuccess = function mysuccess(r) {\n    delete SQLitePlugin.prototype.openDBs[args.path];\n\n    if (!!success) {\n      return success(r);\n    }\n  };\n\n  var myerror = function myerror(e) {\n    if (!!error) {\n      return error(e);\n    } else {\n      plugin.log(\"deleteDatabase error handler not provided: \", e);\n    }\n  };\n\n  plugin.exec(\"delete\", args, mysuccess, myerror);\n};\n\nplugin.sqlitePlugin = {\n  SQLiteFactory: SQLiteFactory,\n  SQLitePluginTransaction: SQLitePluginTransaction,\n  SQLitePlugin: SQLitePlugin,\n  log: plugin.log\n};\nmodule.exports = plugin.sqlitePlugin;","map":{"version":3,"sources":["C:/Users/Anh Duong/Desktop/JS/project/node_modules/react-native-sqlite-storage/lib/sqlite.core.js"],"names":["NativeModules","require","DB_STATE_INIT","DB_STATE_OPEN","READ_ONLY_REGEX","SQLiteFactory","SQLitePlugin","SQLitePluginTransaction","argsArray","dblocations","newSQLError","txLocks","plugin","error","code","sqlError","Error","message","JSON","stringify","nextTick","setImmediate","fun","setTimeout","global","window","args","i","len","arguments","length","call","exec","method","options","success","sqlitePlugin","DEBUG","log","console","warn","openargs","openSuccess","openError","dbname","name","e","open","prototype","databaseFeatures","isSQLitePluginDatabase","openDBs","addTransaction","t","queue","inProgress","push","startNextTransaction","transaction","fn","readTransaction","self","_this","txLock","shift","start","abortAllPendingTransactions","j","len1","ref","tx","abortFromQ","sqlBatch","sqlStatements","batchList","myfn","st","constructor","Array","sql","params","elem","k","len2","results","addStatement","mysuccess","myerror","openerrorcb","opensuccesscb","close","r","path","err","attach","dbNameToAttach","dbAlias","dbName","detach","executeSql","statement","db","txlock","readOnly","executes","run","_error","values","that","finalized","test","handleStatementFailure","sqlStatement","v","toString","errorMsg","handleStatementSuccess","handler","response","payload","rows","item","raw","slice","rowsAffected","insertId","batchExecutes","handlerFor","callbacks","request","tropts","txFailure","waiting","index","didSucceed","abort","finish","qid","result","last","q","res","type","dbargs","failed","succeeded","sqlerror","debug","sqliteFeatures","isSQLitePlugin","openDatabase","errorcb","first","okcb","String","dblocation","location","hasOwnProperty","createFromLocation","assetFilename","androidDatabaseImplementation","androidOldDatabaseImplementation","androidLockWorkaround","androidBugWorkaround","echoTest","inputTestValue","testValue","value","deleteDatabase","module","exports"],"mappings":"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","sourcesContent":["/*\n * sqlite.ios.core.js\n *\n * Created by Andrzej Porebski on 10/29/15.\n * Copyright (c) 2015-2016 Andrzej Porebski.\n *\n * This software is largely based on the SQLLite Storage Cordova Plugin created by Chris Brody & Davide Bertola.\n * The implementation was adopted and converted to use React Native bindings.\n *\n * See https://github.com/litehelpers/Cordova-sqlite-storage\n *\n * This library is available under the terms of the MIT License (2008).\n * See http://opensource.org/licenses/alphabetical for full text.\n */\n\nvar NativeModules = require(\"react-native\").NativeModules;\nvar DB_STATE_INIT, DB_STATE_OPEN, READ_ONLY_REGEX, SQLiteFactory, SQLitePlugin, SQLitePluginTransaction, argsArray, dblocations, newSQLError, txLocks;\n\nvar plugin = {};\n\nREAD_ONLY_REGEX = /^(\\s|;)*(?:alter|create|delete|drop|insert|reindex|replace|update)/i;\n\nDB_STATE_INIT = \"INIT\";\n\nDB_STATE_OPEN = \"OPEN\";\n\ntxLocks = {};\n\nnewSQLError = function(error, code) {\n  var sqlError;\n  sqlError = error;\n  if (!code) {\n    code = 0;\n  }\n  if (!sqlError) {\n    sqlError = new Error(\"a plugin had an error but provided no response\");\n    sqlError.code = code;\n  }\n  if (typeof sqlError === \"string\") {\n    sqlError = new Error(error);\n    sqlError.code = code;\n  }\n  if (!sqlError.code && sqlError.message) {\n    sqlError.code = code;\n  }\n  if (!sqlError.code && !sqlError.message) {\n    sqlError = new Error(\"an unknown error was returned: \" + JSON.stringify(sqlError));\n    sqlError.code = code;\n  }\n  return sqlError;\n};\n\nlet nextTick = setImmediate ||  function(fun) {\n  setTimeout(fun, 0);\n};\n\nif (global.window) {\n  nextTick = window.setImmediate || function(fun) {\n    window.setTimeout(fun, 0);\n  };  \n}\n\n/*\n Utility that avoids leaking the arguments object. See\n https://www.npmjs.org/package/argsarray\n */\n\nargsArray = function(fun) {\n  return function() {\n    var args, i, len;\n    len = arguments.length;\n    if (len) {\n      args = [];\n      i = -1;\n      while (++i < len) {\n        args[i] = arguments[i];\n      }\n      return fun.call(this, args);\n    } else {\n      return fun.call(this, []);\n    }\n  };\n};\n\nplugin.exec = function(method, options, success, error) {\n  if (plugin.sqlitePlugin.DEBUG){\n    plugin.log(\"SQLite.\" + method + \"(\" + JSON.stringify(options) + \")\");\n  }\n  NativeModules[\"SQLite\"][method](options,success,error);\n};\n\nplugin.log = function(...messages) {\n  if (plugin.sqlitePlugin.DEBUG) {\n    console.log(...messages)\n  }\n}\n\nplugin.warn = function(...messages) {\n  console.warn(...messages)\n}\n\nplugin.error = function(...messages) {\n  console.error(...messages)\n}\n\nSQLitePlugin = function(openargs, openSuccess, openError) {\n  var dbname;\n  if (!(openargs && openargs[\"name\"])) {\n    throw newSQLError(\"Cannot create a SQLitePlugin db instance without a db name\");\n  }\n  dbname = openargs.name;\n  if (typeof dbname !== \"string\") {\n    throw newSQLError(\"sqlite plugin database name must be a string\");\n  }\n  this.openargs = openargs;\n  this.dbname = dbname;\n  this.openSuccess = openSuccess;\n  this.openError = openError;\n  this.openSuccess || (this.openSuccess = function() {\n    plugin.log(\"DB opened: \" + dbname);\n  });\n  this.openError || (this.openError = function(e) {\n    plugin.log(e.message);\n  });\n  this.open(this.openSuccess, this.openError);\n};\n\nSQLitePlugin.prototype.databaseFeatures = {\n  isSQLitePluginDatabase: true\n};\n\nSQLitePlugin.prototype.openDBs = {};\n\nSQLitePlugin.prototype.addTransaction = function(t) {\n  if (!txLocks[this.dbname]) {\n    txLocks[this.dbname] = {\n      queue: [],\n      inProgress: false\n    };\n  }\n  txLocks[this.dbname].queue.push(t);\n  if (this.dbname in this.openDBs && this.openDBs[this.dbname] !== DB_STATE_INIT) {\n    this.startNextTransaction();\n  } else {\n    if (this.dbname in this.openDBs) {\n      plugin.log(\"new transaction is waiting for open operation\");\n    } else {\n      plugin.log(\"database is closed, new transaction is [stuck] waiting until db is opened again!\");\n    }\n  }\n};\n\nSQLitePlugin.prototype.transaction = function(fn, error, success) {\n  if (!this.openDBs[this.dbname]) {\n    error(newSQLError(\"database not open\"));\n    return;\n  }\n  this.addTransaction(new SQLitePluginTransaction(this, fn, error, success, true, false));\n};\n\nSQLitePlugin.prototype.readTransaction = function(fn, error, success) {\n  if (!this.openDBs[this.dbname]) {\n    error(newSQLError(\"database not open\"));\n    return;\n  }\n  this.addTransaction(new SQLitePluginTransaction(this, fn, error, success, false, true));\n};\n\nSQLitePlugin.prototype.startNextTransaction = function() {\n  var self;\n  self = this;\n  nextTick((function(_this) {\n    return function() {\n      var txLock;\n      if (!(_this.dbname in _this.openDBs) || _this.openDBs[_this.dbname] !== DB_STATE_OPEN) {\n        plugin.log(\"cannot start next transaction: database not open\");\n        return;\n      }\n      txLock = txLocks[self.dbname];\n      if (!txLock) {\n        plugin.log(\"cannot start next transaction: database connection is lost\");\n      } else if (txLock.queue.length > 0 && !txLock.inProgress) {\n        txLock.inProgress = true;\n        txLock.queue.shift().start();\n      }\n    };\n  })(this));\n};\n\nSQLitePlugin.prototype.abortAllPendingTransactions = function() {\n  var j, len1, ref, tx, txLock;\n  txLock = txLocks[this.dbname];\n  if (!!txLock && txLock.queue.length > 0) {\n    ref = txLock.queue;\n    for (j = 0, len1 = ref.length; j < len1; j++) {\n      tx = ref[j];\n      tx.abortFromQ(newSQLError(\"Invalid database handle\"));\n    }\n    txLock.queue = [];\n    txLock.inProgress = false;\n  }\n};\n\nSQLitePlugin.prototype.sqlBatch = function(sqlStatements, success, error) {\n  var batchList, j, len1, myfn, st;\n  if (!sqlStatements || sqlStatements.constructor !== Array) {\n    throw newSQLError(\"sqlBatch expects an array\");\n  }\n  batchList = [];\n  for (j = 0, len1 = sqlStatements.length; j < len1; j++) {\n    st = sqlStatements[j];\n    if (st.constructor === Array) {\n      if (st.length === 0) {\n        throw newSQLError(\"sqlBatch array element of zero (0) length\");\n      }\n      batchList.push({\n        sql: st[0],\n        params: st.length === 0 ? [] : st[1]\n      });\n    } else {\n      batchList.push({\n        sql: st,\n        params: []\n      });\n    }\n  }\n  myfn = function(tx) {\n    var elem, k, len2, results;\n    results = [];\n    for (k = 0, len2 = batchList.length; k < len2; k++) {\n      elem = batchList[k];\n      results.push(tx.addStatement(elem.sql, elem.params, null, null));\n    }\n    return results;\n  };\n  let mysuccess = function() {\n    if (!!success) {\n      return success();\n    }\n  };\n  let myerror = function(e) {\n    if (!!error) {\n      return error(e);\n    } else {\n      plugin.log(\"Error handler not provided: \",e);\n    }\n  };\n\n  this.addTransaction(new SQLitePluginTransaction(this, myfn, myerror, mysuccess, true, false));\n};\n\n\nSQLitePlugin.prototype.open = function(success, error) {\n  var openerrorcb, opensuccesscb;\n\n  if (this.dbname in this.openDBs && this.openDBs[this.dbname] === DB_STATE_OPEN) {\n    plugin.log(\"database already open: \" + this.dbname);\n    nextTick((function(_this) {\n      return function() {\n        success(_this);\n      };\n    })(this));\n  } else {\n    plugin.log(\"OPEN database: \" + this.dbname);\n    opensuccesscb = (function(_this) {\n      return function() {\n        var txLock;\n        if (!_this.openDBs[_this.dbname]) {\n          plugin.log(\"database was closed during open operation\");\n        }\n        if (_this.dbname in _this.openDBs) {\n          _this.openDBs[_this.dbname] = DB_STATE_OPEN;\n        }\n        if (!!success) {\n          success(_this);\n        }\n        txLock = txLocks[_this.dbname];\n        if (!!txLock && txLock.queue.length > 0 && !txLock.inProgress) {\n          _this.startNextTransaction();\n        }\n      };\n    })(this);\n    openerrorcb = (function(_this) {\n      return function() {\n        plugin.log(\"OPEN database: \" + _this.dbname + \" failed, aborting any pending transactions\");\n        if (!!error) {\n          error(newSQLError(\"Could not open database\"));\n        }\n        delete _this.openDBs[_this.dbname];\n        _this.abortAllPendingTransactions();\n      };\n    })(this);\n    this.openDBs[this.dbname] = DB_STATE_INIT;\n    plugin.exec(\"open\",this.openargs,opensuccesscb, openerrorcb);\n  }\n};\n\nSQLitePlugin.prototype.close = function(success, error) {\n  if (this.dbname in this.openDBs) {\n    if (txLocks[this.dbname] && txLocks[this.dbname].inProgress) {\n      plugin.log(\"cannot close: transaction is in progress\");\n      error(newSQLError(\"database cannot be closed while a transaction is in progress\"));\n      return;\n    }\n    plugin.log(\"CLOSE database: \" + this.dbname);\n    delete this.openDBs[this.dbname];\n    if (txLocks[this.dbname]) {\n      plugin.log(\"closing db with transaction queue length: \" + txLocks[this.dbname].queue.length);\n    } else {\n      plugin.log(\"closing db with no transaction lock state\");\n    }\n    let mysuccess = function(t, r) {\n      if (!!success) {\n        return success(r);\n      }\n    };\n    let myerror = function(t, e) {\n      if (!!error) {\n        return error(e);\n      } else {\n        plugin.log(\"Error handler not provided: \",e);\n      }\n    };\n    plugin.exec(\"close\",{path: this.dbname}, mysuccess, myerror);\n  } else {\n    var err = \"cannot close: database is not open\";\n    plugin.log(err);\n    if (error) {\n      nextTick(function() {\n        return error(err);\n      });\n    }\n  }\n};\n\nSQLitePlugin.prototype.attach = function(dbNameToAttach, dbAlias, success, error) {\n  if (this.dbname in this.openDBs) {\n    if (txLocks[this.dbname] && txLocks[this.dbname].inProgress) {\n      plugin.log(\"cannot attach: transaction is in progress\");\n      error(newSQLError(\"database cannot be attached while a transaction is in progress\"));\n      return;\n    }\n    plugin.log(\"ATTACH database \" + dbNameToAttach + \" to \" + this.dbname + \" with alias \" + dbAlias);\n\n    let mysuccess = function(t, r) {\n      if (!!success) {\n        return success(r);\n      }\n    };\n    let myerror = function(e) {\n      if (!!error) {\n        return error(e);\n      } else {\n        plugin.log(\"Error handler not provided: \",e);\n      }\n    };\n    plugin.exec(\"attach\",{path: this.dbname, dbName: dbNameToAttach, dbAlias}, mysuccess, myerror);\n  } else {\n    let err = \"cannot attach: database is not open\";\n    if (error) {\n      nextTick(function() {\n        return error(err);\n      });\n    }\n  }\n};\n\nSQLitePlugin.prototype.detach = function(dbAlias, success, error) {\n  if (this.dbname in this.openDBs) {\n    if (txLocks[this.dbname] && txLocks[this.dbname].inProgress) {\n      plugin.log(\"cannot attach: transaction is in progress\");\n      error(newSQLError(\"database cannot be attached while a transaction is in progress\"));\n      return;\n    }\n    plugin.log(\"DETACH database \" + dbAlias + \" from \" + this.dbname);\n\n    let mysuccess = function(t, r) {\n      if (!!success) {\n        return success(r);\n      }\n    };\n    let myerror = function(e) {\n      plugin.log(\"ERR\", e);\n      if (!!error) {\n        return error(e);\n      } else {\n        plugin.log(\"Error handler not provided: \",e);\n      }\n    };\n    this.executeSql(\"DETACH DATABASE \" + dbAlias, [], mysuccess, myerror)\n  } else {\n    var err = \"cannot attach: database is not open\";\n    plugin.log(err);\n    if (error) {\n      nextTick(function() {\n        return error(err);\n      });\n    }\n  }\n};\n\nSQLitePlugin.prototype.executeSql = function(statement, params, success, error) {\n  var myerror, myfn, mysuccess;\n  mysuccess = function(t, r) {\n    if (!!success) {\n      return success(r);\n    }\n  };\n  myerror = function(t, e) {\n    if (!!error) {\n      return error(e);\n    } else {\n      plugin.log(\"Error handler not provided: \",e);\n    }\n  };\n  myfn = function(tx) {\n    tx.addStatement(statement, params, mysuccess, myerror);\n  };\n  this.addTransaction(new SQLitePluginTransaction(this, myfn, null, null, false, false));\n};\n\nSQLitePluginTransaction = function(db, fn, error, success, txlock, readOnly) {\n  if (typeof fn !== \"function\") {\n    /*\n     This is consistent with the implementation in Chrome -- it\n     throws if you pass anything other than a function. This also\n     prevents us from stalling our txQueue if somebody passes a\n     false value for fn.\n     */\n    let err = newSQLError(\"transaction expected a function\");\n    if (!!error) {\n      return error(err);\n    } else {\n      throw err;\n    }\n  }\n  this.db = db;\n  this.fn = fn;\n  this.error = error;\n  this.success = success;\n  this.txlock = txlock;\n  this.readOnly = readOnly;\n  this.executes = [];\n  if (txlock) {\n    this.addStatement(\"BEGIN\", [], null, function(tx, err) {\n      throw newSQLError(\"unable to begin transaction: \" + err.message, err.code);\n    });\n  } else {\n    this.addStatement(\"SELECT 1\", [], null, null);\n  }\n};\n\nSQLitePluginTransaction.prototype.start = function() {\n  var err;\n  try {\n    this.fn(this);\n    this.run();\n  } catch (_error) {\n    err = _error;\n    txLocks[this.db.dbname].inProgress = false;\n    this.db.startNextTransaction();\n    if (this.error) {\n      this.error(newSQLError(err));\n    }\n  }\n};\n\nSQLitePluginTransaction.prototype.executeSql = function(sql, values, success, error) {\n  var that = this;\n  if (that.finalized) {\n    throw {\n      message: \"InvalidStateError: DOM Exception 11: This transaction is already finalized. Transactions are committed\" +\n      \" after its success or failure handlers are called. If you are using a Promise to handle callbacks, be aware that\" +\n      \" implementations following the A+ standard adhere to run-to-completion semantics and so Promise resolution occurs\" +\n      \" on a subsequent tick and therefore after the transaction commits.\",\n      code: 11\n    };\n  }\n  if (that.readOnly && READ_ONLY_REGEX.test(sql)) {\n    that.handleStatementFailure(error, {\n      message: \"invalid sql for a read-only transaction\"\n    });\n    return;\n  }\n  let mysuccess = function(t, r) {\n    if (!!success) {\n      return success(t,r);\n    }\n  };\n  let myerror = function(t, e) {\n    if (!!error) {\n      return error(e);\n    } else {\n      plugin.log(\"Error handler not provided: \",e);\n    }\n  };\n  that.addStatement(sql, values, mysuccess, myerror);\n};\n\nSQLitePluginTransaction.prototype.addStatement = function(sql, values, success, error) {\n  var j, len1, params, sqlStatement, t, v;\n  sqlStatement = typeof sql === \"string\" ? sql : sql.toString();\n  params = [];\n  if (!!values && values.constructor === Array) {\n    for (j = 0, len1 = values.length; j < len1; j++) {\n      v = values[j];\n      t = typeof v;\n      if (v === null || v === void 0 || t === \"number\" || t === \"string\"){\n        params.push(v);\n      } else if (t === \"boolean\") {\n        //Convert true -> 1 / false -> 0\n        params.push(~~v);\n      }\n      else if (t !== \"function\") {\n        params.push(v.toString());\n        plugin.warn(\"addStatement - parameter of type <\"+t+\"> converted to string using toString()\")\n      } else {\n        let errorMsg = \"Unsupported parameter type <\"+t+\"> found in addStatement()\";\n        plugin.error(errorMsg);\n        error(newSQLError(errorMsg));\n        return;\n      }\n    }\n  }\n  this.executes.push({\n    success: success,\n    error: error,\n    sql: sqlStatement,\n    params: params\n  });\n};\n\nSQLitePluginTransaction.prototype.handleStatementSuccess = function(handler, response) {\n  // plugin.log(\"handler response:\",response,response.rows);\n  var payload, rows;\n  if (!handler) {\n    return;\n  }\n  rows = response.rows || [];\n  // plugin.log(\"handler rows now:\",rows);\n  payload = {\n    rows: {\n      item: function(i) {\n        return rows[i];\n      },\n      /**\n       * non-standard Web SQL Database method to expose a copy of raw results\n       * @return {Array}\n       */\n      raw: function() {\n        return rows.slice();\n      },\n      length: rows.length\n    },\n    rowsAffected: response.rowsAffected || 0,\n    insertId: response.insertId || void 0\n  };\n  // plugin.log(\"handler response payload:\",payload);\n  handler(this, payload);\n};\n\nSQLitePluginTransaction.prototype.handleStatementFailure = function(handler, response) {\n  if (!handler) {\n    throw newSQLError(\"a statement with no error handler failed: \" + response.message, response.code);\n  }\n  if (handler(this, response) !== false) {\n    throw newSQLError(\"a statement error callback did not return false: \" + response.message, response.code);\n  }\n};\n\nSQLitePluginTransaction.prototype.run = function() {\n  var batchExecutes, handlerFor, i, callbacks, request, tropts, tx, txFailure, waiting;\n  txFailure = null;\n  tropts = [];\n  batchExecutes = this.executes;\n  waiting = batchExecutes.length;\n  this.executes = [];\n  tx = this;\n  handlerFor = function(index, didSucceed) {\n    return function(response) {\n      if (!txFailure) {\n        try {\n          if (didSucceed) {\n            tx.handleStatementSuccess(batchExecutes[index].success, response);\n          } else {\n            tx.handleStatementFailure(batchExecutes[index].error, newSQLError(response));\n          }\n        } catch (err) {\n          let errorMsg = JSON.stringify(err);\n          if(errorMsg === \"{}\") errorMsg = err.toString();\n          plugin.log(\"warning - exception while invoking a callback: \" + errorMsg);\n        }\n\n        if (!didSucceed) {\n          txFailure = newSQLError(response);\n        }\n      }\n      if (--waiting === 0) {\n        if (txFailure) {\n          tx.executes = [];\n          tx.abort(txFailure);\n        } else if (tx.executes.length > 0) {\n          tx.run();\n        } else {\n          tx.finish();\n        }\n      }\n    };\n  };\n  \n  i = 0;\n  callbacks = [];\n  while (i < batchExecutes.length) {\n    request = batchExecutes[i];\n    callbacks.push({\n      success: handlerFor(i, true),\n      error: handlerFor(i, false)\n    });\n    tropts.push({\n      qid: 1111,\n      sql: request.sql,\n      params: request.params\n    });\n    i++;\n  }\n\n  let mysuccess = function(result) {\n    var j, last, q, r, res, type;\n    if (result.length === 0){\n      return;\n    }\n    last = result.length - 1;\n    for (j = 0; j <= last; ++j) {\n      r = result[j];\n      type = r.type;\n      res = r.result;\n      q = callbacks[j];\n      if (q) {\n        if (q[type]) {\n          q[type](res);\n        }\n      }\n    }\n  };\n\n  var myerror = function(error) {\n    plugin.log(\"batch execution error: \",error);\n  };\n\n  plugin.exec(\"backgroundExecuteSqlBatch\",{\n    dbargs: {\n      dbname: this.db.dbname\n    },\n    executes: tropts\n  }, mysuccess, myerror);\n};\n\nSQLitePluginTransaction.prototype.abort = function(txFailure) {\n  var failed, succeeded, tx;\n  if (this.finalized) {\n    return;\n  }\n  tx = this;\n  succeeded = function(tx) {\n    txLocks[tx.db.dbname].inProgress = false;\n    tx.db.startNextTransaction();\n    if (tx.error) {\n      tx.error(txFailure);\n    }\n  };\n  failed = function(tx, err) {\n    txLocks[tx.db.dbname].inProgress = false;\n    tx.db.startNextTransaction();\n    if (tx.error) {\n      tx.error(newSQLError(\"error while trying to roll back: \" + err.message, err.code));\n    }\n  };\n  this.finalized = true;\n  if (this.txlock) {\n    this.addStatement(\"ROLLBACK\", [], succeeded, failed);\n    this.run();\n  } else {\n    succeeded(tx);\n  }\n};\n\nSQLitePluginTransaction.prototype.finish = function() {\n  var failed, succeeded, tx;\n  if (this.finalized) {\n    return;\n  }\n  tx = this;\n  succeeded = function(tx) {\n    txLocks[tx.db.dbname].inProgress = false;\n    tx.db.startNextTransaction();\n    if (tx.success) {\n      tx.success();\n    }\n  };\n  failed = function(tx, err) {\n    txLocks[tx.db.dbname].inProgress = false;\n    tx.db.startNextTransaction();\n    if (tx.error) {\n      tx.error(newSQLError(\"error while trying to commit: \" + err.message, err.code));\n    }\n  };\n  this.finalized = true;\n  if (this.txlock) {\n    this.addStatement(\"COMMIT\", [], succeeded, failed);\n    this.run();\n  } else {\n    succeeded(tx);\n  }\n};\n\nSQLitePluginTransaction.prototype.abortFromQ = function(sqlerror) {\n  if (this.error) {\n    this.error(sqlerror);\n  }\n};\n\ndblocations = {\n  \"default\" : \"nosync\",\n  \"Documents\" : \"docs\",\n  \"Library\" : \"libs\",\n  \"Shared\" : \"shared\"\n};\n\nSQLiteFactory = function(){};\n\nSQLiteFactory.prototype.DEBUG = function(debug) {\n  plugin.log(\"Setting debug to:\",debug);\n  plugin.sqlitePlugin.DEBUG = debug;\n};\n\nSQLiteFactory.prototype.sqliteFeatures = function() {\n  return {\n    isSQLitePlugin: true\n  };\n};\n\nSQLiteFactory.prototype.openDatabase = argsArray(function(args) {\n  var errorcb, first, okcb, openargs, readOnly;\n  if (args.length < 1) {\n    return null;\n  }\n  first = args[0];\n  openargs = null;\n  okcb = errorcb = () => {};\n  if (first.constructor === String) {\n    openargs = {\n      name: first,\n      dblocation : dblocations[\"default\"]\n    };\n    if (args.length >= 5) {\n      okcb = args[4];\n      if (args.length > 5) {\n        errorcb = args[5];\n      }\n    }\n  } else {\n    openargs = first;\n    readOnly = !!openargs.readOnly;\n    if (!readOnly && (!openargs.location || openargs.location.constructor !== String || !dblocations.hasOwnProperty(openargs.location))) {\n      openargs.dblocation = dblocations[\"default\"];\n    } else {\n      openargs.dblocation = dblocations[openargs.location];\n    }\n\n    if (!!openargs.createFromLocation) {\n      if (openargs.createFromLocation === 1) {\n        openargs.assetFilename = \"1\";\n      } else if (typeof openargs.createFromLocation === \"string\"){\n        openargs.assetFilename = openargs.createFromLocation;\n      }\n    }\n\n    if (!!openargs.androidDatabaseImplementation && openargs.androidDatabaseImplementation === 2) {\n      openargs.androidOldDatabaseImplementation = 1;\n    }\n\n    if (!!openargs.androidLockWorkaround && openargs.androidLockWorkaround === 1) {\n      openargs.androidBugWorkaround = 1;\n    }\n\n    if (args.length >= 2) {\n      okcb = args[1];\n      if (args.length > 2) {\n        errorcb = args[2];\n      }\n    }\n  }\n\n  return new SQLitePlugin(openargs, okcb, errorcb);\n});\n\nSQLiteFactory.prototype.echoTest = function(success, error) {\n  let inputTestValue = \"test-string\";\n  let mysuccess = function(testValue) {\n    if (testValue === inputTestValue) {\n      return success();\n    } else {\n      return error(`Mismatch: got: ${testValue} , expected: ${inputTestValue}`);\n    }\n  };\n  let myerror = function(e) {\n    return error(e);\n  };\n\n  plugin.exec(\"echoStringValue\",{value: inputTestValue}, mysuccess, myerror);\n};\n\nSQLiteFactory.prototype.deleteDatabase = function(first,success, error) {\n  var args = {};\n  if (first.constructor === String) {\n    args.path = first;\n    args.dblocation = dblocations[\"default\"];\n  } else {\n    if (!(first && first[\"name\"])) {\n      throw new Error(\"Please specify db name via name property\");\n    }\n    args.path = first.name;\n    if (!first.location || first.location.constructor !== String || !dblocations.hasOwnProperty(first.location)) {\n      args.dblocation = dblocations[\"default\"];\n    } else {\n      args.dblocation = dblocations[first.location];\n    }\n  }\n\n  let mysuccess = function(r) {\n    delete SQLitePlugin.prototype.openDBs[args.path];\n    if (!!success) {\n      return success(r);\n    }\n  };\n\n  let myerror = function(e) {\n    if (!!error) {\n      return error(e);\n    } else {\n      plugin.log(\"deleteDatabase error handler not provided: \",e);\n    }\n  };\n\n  plugin.exec(\"delete\",args,mysuccess,myerror);\n};\n\nplugin.sqlitePlugin = {\n  SQLiteFactory : SQLiteFactory,\n  SQLitePluginTransaction : SQLitePluginTransaction,\n  SQLitePlugin : SQLitePlugin,\n  log: plugin.log\n};\n\nmodule.exports = plugin.sqlitePlugin;\n"]},"metadata":{},"sourceType":"script"}